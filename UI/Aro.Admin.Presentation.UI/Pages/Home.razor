@page "/"


@attribute [Authorize]
@using Microsoft.AspNetCore.Components.Authorization

<PageTitle>ARO Admin - Home</PageTitle>

<AuthorizeView>
    <Authorized>
        <div class="home-main-content">
            <!-- Search Icon - Top Right Corner with Circle Background -->
            <div class="top-right-section">
                <div class="top-right-profile">
                    <img class="profile-img" Src="icons/profile.png" />
                    <span class="property-name">Brochner hotels</span>
                    <img src="icons/dropdown.png" alt="Dropdown" class="dropdown-icon"   />
                </div>
                <div class="top-right-icons" @onclick="HandleSearch">
                    <img src="icons/searchicon.png" alt="Search" />
                </div>

                <div class="top-right-icons" @onclick="HandleSettings">
                    <img src="icons/settings.png" alt="Settings" />
                </div>
            </div>

            <!-- Content Card - White Box with Shadow (Figma Rectangle 1904) -->
            <div class="content-card">
                <div class="content-row">
                    <!-- Greeting Section - Left Side -->
                    <div class="greeting-section">
                        <h1>Hi @GetFirstName(context.User.Identity?.Name)!</h1>
                        <p>You don't have any properties added yet.</p>
                    </div>

                    <!-- Button Section - Right Side -->
                    <div class="button-section">
                        <button class="aro-button-primary" @onclick="HandleAddGroup">
                            Add Property +
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </Authorized>
    <NotAuthorized>
        <RedirectToLogin />
    </NotAuthorized>
</AuthorizeView>

@code {
    [Inject] private NavigationManager? NavigationManager { get; set; }

    private string GetFirstName(string? fullName)
    {
        if (string.IsNullOrWhiteSpace(fullName))
            return "Alex";

        // Try to extract first name from email or full name
        if (fullName.Contains("@"))
        {
            var emailPart = fullName.Split('@')[0];
            var nameParts = emailPart.Split('.');
            return char.ToUpper(nameParts[0][0]) + nameParts[0].Substring(1);
        }

        var parts = fullName.Split(' ');
        return parts[0];
    }

    private void HandleAddGroup()
    {
        // Navigate to property information wizard
        NavigationManager?.NavigateTo("/property/information");
    }

    private void HandleSearch()
    {
        // Implement search functionality
         NavigationManager?.NavigateTo("/search");
    }
    private void HandleSettings()
    {
        // Implement search functionality
        NavigationManager?.NavigateTo("/settings");
    }
}

